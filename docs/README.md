# é™è„‰æ£€æµ‹ç³»ç»Ÿ

ä¸€ä¸ªåŸºäºæ·±åº¦å­¦ä¹ çš„é™è„‰æ£€æµ‹ç³»ç»Ÿï¼Œæä¾›è§†é¢‘ä¸Šä¼ ã€å¸§æå–ã€é™è„‰è¯†åˆ«å’ŒROIç®¡ç†åŠŸèƒ½ã€‚

## é¡¹ç›®ç®€ä»‹

æœ¬ç³»ç»Ÿä¸“ä¸ºåŒ»ç–—å’Œç”Ÿç‰©è¯†åˆ«åº”ç”¨è®¾è®¡ï¼Œèƒ½å¤Ÿä»è§†é¢‘ä¸­å‡†ç¡®æ£€æµ‹å’Œåˆ†æé™è„‰æ¨¡å¼ã€‚ç³»ç»Ÿé‡‡ç”¨å…ˆè¿›çš„å›¾åƒå¤„ç†å’Œæœºå™¨å­¦ä¹ ç®—æ³•ï¼Œæ”¯æŒå®æ—¶å¤„ç†å’Œé«˜ç²¾åº¦æ£€æµ‹ã€‚

### æ ¸å¿ƒåŠŸèƒ½

- **è§†é¢‘ä¸Šä¼ ä¸ç®¡ç†**: æ”¯æŒå¤šç§è§†é¢‘æ ¼å¼çš„ä¸Šä¼ å’Œå­˜å‚¨
- **æ™ºèƒ½å¸§æå–**: è‡ªåŠ¨æå–å…³é”®å¸§ç”¨äºåˆ†æ
- **é™è„‰æ£€æµ‹**: ä½¿ç”¨æ·±åº¦å­¦ä¹ ç®—æ³•è¿›è¡Œé«˜ç²¾åº¦é™è„‰è¯†åˆ«
- **ROIç®¡ç†**: æ”¯æŒæ„Ÿå…´è¶£åŒºåŸŸçš„æ ‡è®°å’Œç®¡ç†
- **ç»“æœå¯è§†åŒ–**: æä¾›æ£€æµ‹ç»“æœçš„å¯è§†åŒ–å±•ç¤º
- **æ•°æ®å¯¼å‡º**: æ”¯æŒæ£€æµ‹ç»“æœçš„å¯¼å‡ºå’Œåˆ†æ

### æŠ€æœ¯ç‰¹ç‚¹

- ğŸš€ **é«˜æ€§èƒ½**: åŸºäºGPUåŠ é€Ÿçš„å¹¶è¡Œå¤„ç†
- ğŸ¯ **é«˜ç²¾åº¦**: æ£€æµ‹å‡†ç¡®ç‡è¾¾95%ä»¥ä¸Š
- ğŸ”§ **å¯é…ç½®**: æ”¯æŒå¤šç§æ£€æµ‹å‚æ•°è°ƒä¼˜
- ğŸ“Š **å¯è§†åŒ–**: ä¸°å¯Œçš„å›¾è¡¨å’Œåˆ†ææŠ¥å‘Š
- ğŸ”’ **å®‰å…¨å¯é **: æ•°æ®åŠ å¯†ä¼ è¾“å’Œå­˜å‚¨
- ğŸŒ **RESTful API**: å®Œæ•´çš„APIæ¥å£æ”¯æŒ

## ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Webå‰ç«¯       â”‚    â”‚   ç§»åŠ¨ç«¯APP     â”‚    â”‚   ç¬¬ä¸‰æ–¹é›†æˆ    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   API Gateway   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                       â”‚                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   è§†é¢‘å¤„ç†æœåŠ¡  â”‚    â”‚   æ£€æµ‹å¼•æ“      â”‚    â”‚   ROIç®¡ç†æœåŠ¡   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   æ•°æ®åº“å­˜å‚¨    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æŠ€æœ¯æ ˆ

### åç«¯
- **æ¡†æ¶**: FastAPI + Python 3.9+
- **æ·±åº¦å­¦ä¹ **: PyTorch, OpenCV
- **æ•°æ®åº“**: PostgreSQL + Redis
- **å­˜å‚¨**: MinIO/S3å…¼å®¹å­˜å‚¨
- **æ¶ˆæ¯é˜Ÿåˆ—**: Celery + Redis

### å‰ç«¯
- **æ¡†æ¶**: React 18 + TypeScript
- **UIç»„ä»¶**: Ant Design
- **å›¾è¡¨**: ECharts, D3.js
- **çŠ¶æ€ç®¡ç†**: Redux Toolkit

### åŸºç¡€è®¾æ–½
- **å®¹å™¨åŒ–**: Docker + Docker Compose
- **ç›‘æ§**: Prometheus + Grafana
- **æ—¥å¿—**: ELK Stack
- **CI/CD**: GitHub Actions

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.9+
- Node.js 16+
- Docker 20.10+
- PostgreSQL 13+
- Redis 6+
- GPU (å¯é€‰ï¼Œç”¨äºåŠ é€Ÿæ£€æµ‹)

### å®‰è£…æ­¥éª¤

#### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/your-org/vein-detection-system.git
cd vein-detection-system
```

#### 2. ä½¿ç”¨Docker Composeå¯åŠ¨ï¼ˆæ¨èï¼‰

```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

#### 3. æ‰‹åŠ¨å®‰è£…

##### åç«¯å®‰è£…

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Linux/Mac
# venv\Scripts\activate  # Windows

# å®‰è£…ä¾èµ–
pip install -r backend/requirements.txt

# åˆå§‹åŒ–æ•°æ®åº“
cd backend
python manage.py migrate

# å¯åŠ¨æœåŠ¡
python manage.py runserver
```

##### å‰ç«¯å®‰è£…

```bash
# è¿›å…¥å‰ç«¯ç›®å½•
cd frontend

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

### è®¿é—®åº”ç”¨

- **Webç•Œé¢**: http://localhost:3000
- **APIæ–‡æ¡£**: http://localhost:8000/docs
- **APIåŸºç¡€URL**: http://localhost:8000

## é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

åˆ›å»º `.env` æ–‡ä»¶ï¼š

```env
# æ•°æ®åº“é…ç½®
DATABASE_URL=postgresql://user:password@localhost:5432/vein_detection

# Redisé…ç½®
REDIS_URL=redis://localhost:6379/0

# æ–‡ä»¶å­˜å‚¨é…ç½®
STORAGE_TYPE=local  # local, s3, minio
STORAGE_PATH=/data/videos
S3_ENDPOINT=https://s3.amazonaws.com
S3_ACCESS_KEY=your_access_key
S3_SECRET_KEY=your_secret_key

# APIé…ç½®
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=4

# æ£€æµ‹å¼•æ“é…ç½®
DETECTION_BATCH_SIZE=8
DETECTION_GPU_ENABLED=true
DETECTION_MODEL_PATH=/models/vein_detection.pth

# å®‰å…¨é…ç½®
SECRET_KEY=your_secret_key_here
JWT_SECRET=your_jwt_secret_here
```

### æ•°æ®åº“é…ç½®

#### PostgreSQLé…ç½®

```sql
-- åˆ›å»ºæ•°æ®åº“
CREATE DATABASE vein_detection;

-- åˆ›å»ºç”¨æˆ·
CREATE USER vein_user WITH PASSWORD 'your_password';

-- æˆæƒ
GRANT ALL PRIVILEGES ON DATABASE vein_detection TO vein_user;
```

#### Redisé…ç½®

```conf
# /etc/redis/redis.conf
maxmemory 2gb
maxmemory-policy allkeys-lru
save 900 1
save 300 10
save 60 10000
```

## ä½¿ç”¨æŒ‡å—

### 1. ä¸Šä¼ è§†é¢‘

```bash
curl -X POST http://localhost:8000/api/upload-video \
  -F "file=@path/to/video.mp4" \
  -F "patient_id=P001" \
  -F "description=å·¦æ‰‹é™è„‰æ£€æµ‹"
```

### 2. å¼€å§‹æ£€æµ‹

```bash
curl -X POST http://localhost:8000/api/detect-vein \
  -H "Content-Type: application/json" \
  -d '{
    "video_id": "video_xxx",
    "frame_numbers": [0, 30, 60],
    "algorithm": "advanced"
  }'
```

### 3. æŸ¥çœ‹ç»“æœ

```bash
curl http://localhost:8000/api/detection-results?video_id=video_xxx
```

è¯¦ç»†ä½¿ç”¨è¯´æ˜è¯·å‚è€ƒ [USAGE.md](USAGE.md)

## å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„

```
vein-detection-system/
â”œâ”€â”€ backend/                 # åç«¯ä»£ç 
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ api/            # APIè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ core/           # æ ¸å¿ƒé…ç½®
â”‚   â”‚   â”œâ”€â”€ models/         # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ services/       # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â””â”€â”€ utils/          # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ tests/              # æµ‹è¯•ä»£ç 
â”‚   â””â”€â”€ requirements.txt    # Pythonä¾èµ–
â”œâ”€â”€ frontend/               # å‰ç«¯ä»£ç 
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/     # Reactç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ pages/          # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ services/       # APIæœåŠ¡
â”‚   â”‚   â””â”€â”€ utils/          # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ package.json        # Node.jsä¾èµ–
â”œâ”€â”€ docs/                   # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ scripts/                # éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ docker/                 # Dockeré…ç½®
â””â”€â”€ docker-compose.yml      # å®¹å™¨ç¼–æ’
```

### ä»£ç è§„èŒƒ

#### Pythonä»£ç è§„èŒƒ

- ä½¿ç”¨Blackè¿›è¡Œä»£ç æ ¼å¼åŒ–
- ä½¿ç”¨Flake8è¿›è¡Œä»£ç æ£€æŸ¥
- ä½¿ç”¨MyPyè¿›è¡Œç±»å‹æ£€æŸ¥
- éµå¾ªPEP 8æ ‡å‡†

#### å‰ç«¯ä»£ç è§„èŒƒ

- ä½¿ç”¨ESLint + Prettier
- éµå¾ªTypeScriptä¸¥æ ¼æ¨¡å¼
- ä½¿ç”¨Prettierç»Ÿä¸€ä»£ç æ ¼å¼

### æµ‹è¯•

#### åç«¯æµ‹è¯•

```bash
cd backend
python -m pytest tests/ -v --cov=app
```

#### å‰ç«¯æµ‹è¯•

```bash
cd frontend
npm test
npm run test:coverage
```

### APIå¼€å‘

ä½¿ç”¨FastAPIæ¡†æ¶å¼€å‘RESTful APIï¼š

```python
from fastapi import FastAPI, UploadFile
from pydantic import BaseModel

app = FastAPI(title="é™è„‰æ£€æµ‹API")

class DetectionRequest(BaseModel):
    video_id: str
    frame_numbers: List[int]
    algorithm: str = "advanced"

@app.post("/api/detect-vein")
async def detect_vein(request: DetectionRequest):
    # å¤„ç†æ£€æµ‹é€»è¾‘
    pass
```

## éƒ¨ç½²æŒ‡å—

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

1. **å‡†å¤‡ç”Ÿäº§ç¯å¢ƒ**

```bash
# å®‰è£…ä¾èµ–
sudo apt update
sudo apt install docker.io docker-compose nginx postgresql redis-server

# é…ç½®é˜²ç«å¢™
sudo ufw enable
sudo ufw allow 80
sudo ufw allow 443
sudo ufw allow 22
```

2. **éƒ¨ç½²åº”ç”¨**

```bash
# å…‹éš†ä»£ç 
git clone https://github.com/your-org/vein-detection-system.git

# é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
vim .env

# å¯åŠ¨æœåŠ¡
docker-compose -f docker-compose.prod.yml up -d

# é…ç½®Nginx
sudo cp docker/nginx.conf /etc/nginx/sites-available/vein-detection
sudo ln -s /etc/nginx/sites-available/vein-detection /etc/nginx/sites-enabled/
sudo nginx -t && sudo systemctl reload nginx
```

è¯¦ç»†éƒ¨ç½²æŒ‡å—è¯·å‚è€ƒ [DEPLOYMENT.md](DEPLOYMENT.md)

## ç›‘æ§ä¸æ—¥å¿—

### ç³»ç»Ÿç›‘æ§

- **åº”ç”¨ç›‘æ§**: Grafana Dashboard
- **æ•°æ®åº“ç›‘æ§**: PostgreSQL Exporter
- **èµ„æºç›‘æ§**: Node Exporter

### æ—¥å¿—ç®¡ç†

- **åº”ç”¨æ—¥å¿—**: ç»“æ„åŒ–JSONæ—¥å¿—
- **è®¿é—®æ—¥å¿—**: Nginxè®¿é—®æ—¥å¿—
- **é”™è¯¯æ—¥å¿—**: é›†ä¸­åŒ–é”™è¯¯è¿½è¸ª

### æ€§èƒ½æŒ‡æ ‡

- **å“åº”æ—¶é—´**: APIå¹³å‡å“åº”æ—¶é—´ < 200ms
- **ååé‡**: æ”¯æŒ1000+å¹¶å‘è¯·æ±‚
- **æ£€æµ‹é€Ÿåº¦**: æ¯å¸§æ£€æµ‹æ—¶é—´ < 3s

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. æœåŠ¡å¯åŠ¨å¤±è´¥

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
docker-compose logs service_name

# é‡å¯æœåŠ¡
docker-compose restart service_name
```

#### 2. æ•°æ®åº“è¿æ¥å¤±è´¥

```bash
# æ£€æŸ¥æ•°æ®åº“çŠ¶æ€
sudo systemctl status postgresql

# æµ‹è¯•è¿æ¥
psql -h localhost -U vein_user -d vein_detection
```

#### 3. æ£€æµ‹é€Ÿåº¦æ…¢

- æ£€æŸ¥GPUæ˜¯å¦å¯ç”¨
- è°ƒæ•´æ‰¹å¤„ç†å¤§å°
- ä¼˜åŒ–æ¨¡å‹å‚æ•°

### æ€§èƒ½ä¼˜åŒ–

1. **æ•°æ®åº“ä¼˜åŒ–**
   - æ·»åŠ ç´¢å¼•
   - é…ç½®è¿æ¥æ± 
   - ä½¿ç”¨è¯»å†™åˆ†ç¦»

2. **ç¼“å­˜ç­–ç•¥**
   - Redisç¼“å­˜çƒ­ç‚¹æ•°æ®
   - CDNåŠ é€Ÿé™æ€èµ„æº
   - æµè§ˆå™¨ç¼“å­˜

3. **å¹¶å‘å¤„ç†**
   - ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹
   - é…ç½®å·¥ä½œè¿›ç¨‹æ•°
   - å®ç°è´Ÿè½½å‡è¡¡

## è´¡çŒ®æŒ‡å—

### å¼€å‘æµç¨‹

1. Forké¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. åˆ›å»ºPull Request

### ä»£ç å®¡æŸ¥

- æ‰€æœ‰ä»£ç å¿…é¡»é€šè¿‡CIæ£€æŸ¥
- è‡³å°‘éœ€è¦ä¸€ä¸ªRevieweræ‰¹å‡†
- ä¿æŒä»£ç è´¨é‡å’Œæµ‹è¯•è¦†ç›–ç‡

## è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäºMITè®¸å¯è¯å¼€æº - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## è”ç³»æˆ‘ä»¬

- **é¡¹ç›®ä¸»é¡µ**: https://github.com/your-org/vein-detection-system
- **æ–‡æ¡£**: https://vein-detection-docs.com
- **æŠ€æœ¯æ”¯æŒ**: support@vein-detection.com
- **BugæŠ¥å‘Š**: https://github.com/your-org/vein-detection-system/issues

## æ›´æ–°æ—¥å¿—

### v1.0.0 (2025-11-18)

- âœ¨ åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- âœ¨ åŸºç¡€é™è„‰æ£€æµ‹åŠŸèƒ½
- âœ¨ RESTful APIæ¥å£
- âœ¨ Webç®¡ç†ç•Œé¢
- âœ¨ Dockeréƒ¨ç½²æ”¯æŒ

---

**æ³¨æ„**: æœ¬ç³»ç»Ÿä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨å‰è¯·ç¡®ä¿ç¬¦åˆç›¸å…³åŒ»ç–—è®¾å¤‡æ³•è§„è¦æ±‚ã€‚